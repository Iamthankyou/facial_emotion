(this["webpackJsonpcamera-test"]=this["webpackJsonpcamera-test"]||[]).push([[0],{23:function(e,t,n){},26:function(e,t,n){e.exports=n.p+"static/media/loading.5ce78eb5.gif"},29:function(e,t,n){e.exports=n(53)},34:function(e,t,n){},40:function(e,t){},41:function(e,t){},42:function(e,t){},44:function(e,t){},45:function(e,t){},46:function(e,t){},47:function(e,t){},48:function(e,t){},49:function(e,t){},53:function(e,t,n){"use strict";n.r(t);var a,r=n(2),c=n.n(r),i=n(24),o=n.n(i),s=(n(34),n(7)),l=n(5),u=n.n(l),d=n(9),m=(n(23),n(8)),h=n(25),f=n.n(h),p=n(10),b=function(){var e=Object(d.a)(u.a.mark((function e(t){var n,a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(n=t.getBoundingClientRect(),0!==(a={width:n.width,height:n.height}).height){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,m.b(t,new m.a({inputSize:320}));case 8:return r=e.sent,e.abrupt("return",m.f(r,a));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(d.a)(u.a.mark((function e(t,n,r,c,i,o,s){var l,d,h,b,v;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&n&&r)){e.next=9;break}if(l=t.getBoundingClientRect(),d={width:l.width,height:l.height},m.d(n,d),n.getContext("2d").clearRect(0,0,n.width,n.height),0===d.width){e.next=9;break}return(h=m.f(r,d))[0]&&(b=h[0].box,v={lineWidth:2},new m.c.DrawBox(b,v).draw(n),f.a.read(i).then((function(e){e.crop(h[0].box.x,h[0].box.y,h[0].box.width,h[0].box.height),e.resize(48,48),e=e.bitmap.data,e=(e=(e=(e=(e=p.b(e,[48,48,4])).mean(2)).expandDims(2)).div(255)).reshape([1,48,48,1]);var t=s.predict(e);t=t.dataSync(),a=t}))),e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})));return function(t,n,a,r,c,i,o){return e.apply(this,arguments)}}(),w=n(26),g=n.n(w),x=n(27),E=n.n(x);var y=function(e){var t=window.innerWidth/window.innerHeight;return c.a.createElement("div",{className:"camera__wrapper",style:{width:t>1?"80%":"33vh"}},c.a.createElement(E.a,{screenshotFormat:"image/jpeg",audio:!1,ref:e.camera,width:"100%",height:"auto",className:"camera"}),c.a.createElement("canvas",{className:"webcam-overlay",ref:e.cameraCanvas}))},k=n(28),j=n.n(k),O=n(21),N=n(11),S=n(4);!function(){var e="".concat("","/models");Promise.all([m.e.tinyFaceDetector.loadFromUri(e)]).then((function(){console.log("loaded")}))}(),N.b.add(S.m,S.b,S.j,S.a,S.f,S.d,S.e,S.h,S.i,S.k,S.g,S.c,S.l);var C=function(){Object(r.useEffect)((function(){l().then((function(){C(!1),t()}))}),[]);var e=function(e){e.current.getContext("2d").clearRect(0,0,e.width,e.height)},t=function(){if(null!==m){var t=setInterval(Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n();case 2:case"end":return e.stop()}}),e)}))),200);return function(){e(h),clearInterval(t)}}return e(h)},n=function(){var e=Object(d.a)(u.a.mark((function e(){var t,n,r,c,i,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===m.current){e.next=11;break}return e.next=3,b(m.current.video);case 3:return t=e.sent,n=m.current.getScreenshot(),e.next=7,v(m.current.video,h.current,t,"boxLandmarks",n,f,a);case 7:r=e.sent,c=["angry","disgusted","afraid","happy","sad","surprised","neutral"],void 0!==r&&(i=r.reduce((function(e,t){return Math.max(e,t)})),o=r.indexOf(i),_(c[o])),E(t);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),a=null,i=window.innerWidth/window.innerHeight,o=function(){G(!0)},l=function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(window.innerWidth,"innnnnnnner"),!("indexedDB"in window)){e.next=17;break}return e.prev=2,e.next=5,p.a("indexeddb://web-model");case 5:a=e.sent,e.next=15;break;case 8:return e.prev=8,e.t0=e.catch(2),console.log(e.t0),e.next=13,p.a("./jsmodel/model.json");case 13:(a=e.sent).save("indexeddb://web-model");case 15:e.next=21;break;case 17:return console.warn("IndexedDB not supported."),e.next=20,p.a("./jsmodel/model.json");case 20:a=e.sent;case 21:I(!0),console.log("model loaded");case 23:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(){return e.apply(this,arguments)}}(),m=Object(r.useRef)(),h=Object(r.useRef)(),f=Object(r.useRef)(),w=Object(r.useState)([]),x=Object(s.a)(w,2),E=(x[0],x[1]),k=Object(r.useState)(!0),N=Object(s.a)(k,2),S=N[0],C=N[1],D=Object(r.useState)(!1),W=Object(s.a)(D,2),I=(W[0],W[1]),B=Object(r.useState)(""),R=Object(s.a)(B,2),L=R[0],_=R[1],F=Object(r.useState)(""),T=Object(s.a)(F,2),z=T[0],A=T[1],M=Object(r.useState)(null),U=Object(s.a)(M,2),H=U[0],J=U[1],P=Object(r.useState)(!0),$=Object(s.a)(P,2),q=$[0],G=$[1],K=Object(r.useState)(!1),Q=Object(s.a)(K,2),V=Q[0],X=Q[1];return c.a.createElement("div",null,S&&c.a.createElement("div",{style:{textAlign:"center",marginTop:"30vh"}},c.a.createElement("img",{src:g.a}),c.a.createElement("h2",{style:{color:"#007c6c"}},"Downloading Model")),!S&&c.a.createElement("div",null,c.a.createElement("div",{className:"titleDiv"},c.a.createElement("div",{style:{marginLeft:"10px",marginTop:"1vh"}},c.a.createElement("h4",{style:{fontSize:"4vh"}},"Facial Emotion Detector"),c.a.createElement("a",{className:"nostyle",href:"https://github.com/amilkh/cs230-fer"},"Deep learning model"),c.a.createElement("p",{className:"nostyle"},"\xa0by\xa0"),c.a.createElement("a",{className:"nostyle",href:"https://cs230.stanford.edu/"},"Stanford University"),c.a.createElement("br",null),c.a.createElement("a",{className:"nostyle",href:"https://github.com/amilkh/cs230-fer/tree/master/webapp"},"Web app"),c.a.createElement("p",{className:"nostyle"},"\xa0by\xa0"),c.a.createElement("a",{className:"nostyle",href:"https://se.neduet.edu.pk/"},"NED University"),c.a.createElement("div",{style:{marginLeft:i>1?"92vw":"80vw"}},c.a.createElement(j.a,{onChange:function(){X(!V),o()},uncheckedIcon:c.a.createElement(O.a,{style:{marginLeft:"8px",marginTop:"5px"},icon:"video"}),checkedIcon:c.a.createElement(O.a,{style:{marginLeft:"10px",marginTop:"5px"},icon:"camera"}),checked:!V,className:"App__switcher-switch",offColor:"#b3f5e5",onColor:"#b3f5e5",width:60})))),c.a.createElement("div",{className:"camera",align:"center"},c.a.createElement("div",{id:"cam_input"},c.a.createElement("div",{style:{display:q?"block":"none"}},c.a.createElement(y,{camera:m,cameraCanvas:h})),!q&&c.a.createElement("img",{className:"camera",src:H})),!V&&c.a.createElement("div",null,q&&c.a.createElement("button",{style:{width:i>1?window.innerWidth/100*80:"33vh"},className:"detect",onClick:function(){return function(){if(A(L),m)var e=m.current.getScreenshot();G(!1),J(e)}()}},"Detect My Emotion"),!q&&c.a.createElement("button",{style:{width:i>1?window.innerWidth/100*80:"33vh"},className:"detect",onClick:function(){return o()}},"Capture Again"))),c.a.createElement("div",{className:"footer"},V&&""!==L&&c.a.createElement("h3",null,"I think you look ",L,"."),!V&&""!==z&&c.a.createElement("h3",null,"I think you look ",z,"."))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(c.a.createElement(C,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[29,1,2]]]);
//# sourceMappingURL=main.605c0c84.chunk.js.map